# =============================================================================
# Policy Mesh — environment configuration example
# Copy to .env and adjust. For Docker Compose, the app service overrides
# DATABASE_URL to use host "postgres"; use localhost for migrations from host.
# =============================================================================

# -----------------------------------------------------------------------------
# Database (Postgres)
# -----------------------------------------------------------------------------
# Used by: docker-compose postgres service; app for audit persistence.
POSTGRES_USER=policy_mesh
POSTGRES_PASSWORD=change-me
POSTGRES_DB=policy_mesh
POSTGRES_PORT=5432

# Connection string for the app and for running migrations from the host.
# In Docker, the app container gets DATABASE_URL overridden to use host "postgres".
DATABASE_URL=postgresql+psycopg://policy_mesh:change-me@localhost:5432/policy_mesh

# Set to false to disable audit writes even when DATABASE_URL is set.
# AUDIT_ENABLED=true

# -----------------------------------------------------------------------------
# Routing policy (DecisionEngine: sensitivity → cost → default)
# -----------------------------------------------------------------------------
# Provider when no rule matches. Options: openai | local (default: openai).
# DEFAULT_PROVIDER=openai

# If the prompt contains any of these words (case-insensitive), route to local.
# Comma-separated list; leave empty to disable the sensitivity rule.
# SENSITIVITY_KEYWORDS=internal,confidential,secret

# Cost rule — character length. Prefer local when prompt length (chars) ≤ this.
# Used when USD cost mode (below) is not configured. Default: 1000.
# COST_MAX_PROMPT_LENGTH_FOR_LOCAL=1000

# -----------------------------------------------------------------------------
# Cost rule — USD threshold (optional; when set, overrides length rule above)
# -----------------------------------------------------------------------------
# When both COST_MAX_USD_FOR_LOCAL and OPENAI_INPUT_USD_PER_1K_TOKENS are set,
# the engine uses: tokens ≈ chars/COST_CHARS_PER_TOKEN, cost_usd ≈ (tokens/1000)*price.
# Prefer local when cost_usd ≤ COST_MAX_USD_FOR_LOCAL. Approximate only.
# COST_MAX_USD_FOR_LOCAL=0.09
# OPENAI_INPUT_USD_PER_1K_TOKENS=0.0015
# COST_CHARS_PER_TOKEN=4

# -----------------------------------------------------------------------------
# Providers (Ollama & OpenAI)
# -----------------------------------------------------------------------------
# Ollama API base URL. In Docker Compose use http://ollama:11434; on host use localhost.
OLLAMA_BASE_URL=http://localhost:11434

# OpenAI: required when routing to OpenAI. No default.
# OPENAI_API_KEY=sk-...

# Optional override for OpenAI API base (e.g. proxy or alternate endpoint).
# OPENAI_BASE_URL=https://api.openai.com

# HTTP timeout in seconds for provider requests. Default: 60.
# PROVIDER_TIMEOUT_SECONDS=60
